---
layout: mypost
title: 2020年全国职业院校技能大赛改革试点赛
categories: [技能大赛]
---



# 网络安全竞赛试题

为赛卷一，环境都是自己做的，仅作参考
（一）（总分100分）

赛题说明
一、竞赛项目简介
“网络安全”竞赛共分A. 基础设施设置与安全加固；B. 网络安全事件响应、数字取证调查和应用安全；C. CTF夺旗-攻击；D. CTF夺旗-防御等四个模块。根据比赛实际情况，竞赛赛场实际使用赛题参数、表述及环境可能有适当修改，具体情况以实际比赛发放赛题为准。竞赛时间安排和分值权重见表1。
表1  竞赛时间安排与分值权重
模块编号	模块名称	竞赛时间
（小时）	权值
A	基础设施设置与安全加固	3	20%
B	网络安全事件响应、数字取证调查和应用安全		40%
C	CTF夺旗-攻击 	3	20%
D	CTF夺旗-防御		20%
总计	6	100%

二、竞赛注意事项
1.比赛期间禁止携带和使用移动存储设备、计算器、通信工具及参考资料。
2.请根据大赛所提供的比赛环境，检查所列的硬件设备、软件清单、材料清单是否齐全，计算机设备是否能正常使用。
3.在进行任何操作之前，请阅读每个部分的所有任务。各任务之间可能存在一定关联。
4.操作过程中需要及时按照答题要求保存相关结果。比赛结束后，所有设备保持运行状态，评判以最后提交的成果为最终依据。
5.比赛完成后，比赛设备、软件和赛题请保留在座位上，禁止将比赛所用的所有物品（包括试卷等）带离赛场。
6.禁止在提交资料上填写与竞赛无关的标记，如违反规定，可视为0分。

## 竞赛内容
### 模块A 基础设施设置与安全加固
（本模块20分）
一、项目和任务描述：
假定你是某企业的网络安全工程师，对于企业的服务器系统，根据任务要求确保各服务正常运行，并通过综合运用登录和密码策略、数据库安全策略、流量完整性保护策略、事件监控策略、防火墙策略等多种安全策略来提升服务器系统的网络安全防御能力。本模块要求对具体任务的操作截图并加以相应的文字说明,以word文档的形式书写,以PDF格式保存,以赛位号作为文件名.
二、服务器环境说明
IDS:入侵检测系统服务器(Snort),操作系统为Linux
LOG:日志服务器(Splunk),操作系统为Linux
Web:IIS服务器,操作系统为Windows
Data:数据库服务器(Mysql),操作系统为Linux
三、具体任务（每个任务得分以电子答题卡为准）

#### A-1任务一登录安全加固

请对服务器Log、Web、Data 按要求进行相应的设置，提高服务器的安全性。
<font color='red'> //log，web，data三台服务器都需要相同配置

1.	密码策略（Log,Web,Data）
	a.	最小密码长度不少于8个字符;
	<font color='red'> 操作：
  authconfig --passminlen=8 --update
  
	b.	密码策略必须同时满足大小写字母、数字、特殊字符。
<font color='red'>操作：
authconfig --enablereqlower –update  //一位小写字符
authconfig --enablerequpper –update  //一位大写字符
authconfig --enablereqdigit –update  //一位数字字符
authconfig --enablereqother –update  //一位其它字符
2. 登录策略（Log,Web,Data）
a.在用户登录系统时，应该有“For authorized users only”提示信息; 
<font color='red'>  操作：
修改/etc/issue文件为For authorized users only 
修改/etc/issue.net文件，修改ssh登陆前的提示信息。在/etc/ssh/sshd_config 的 banner信息，重启服务
修改/etc/motd文件为For authorized users only ，保存通过
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093257657.png#pic_center)

	c.	一分钟内仅允许5次登录失败的尝试，超过5次，登录帐号锁定1分钟；	
<font color='red'> 操作：
在/etc/pam.d/login文件或 /etc/pam.d/system-auth-ac文件添加auth	required pam_tally2.so deny=5 unlock_time=60

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093331693.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

远程用户非活动会话连接超时应小于等于5分钟。
<font color='red'> 操作：
修改/etc/ssh/sshd_config ClientAliveInterval 300 //秒为单位
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093356429.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

**Ps：PAM认证模块 和 密码策略**

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093416601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093421148.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)


3. 用户安全管理(Web)
	a.对服务器进行远程管理安全性SSL加固，防止敏感信息泄露被监听;
<font color='red'> 在httpd.conf里开启模块
这个题的的证书应该在后面重定向会做
LoadModule ssl_module modules/mod_ssl.so
LoadModule rewrite_module modules/mod_rewrite.so

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093501890.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093508211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

b.查找并删除服务器中可能存在的帐号hacker;
<font color='red'>/etc/passwd

d.	普通用户进行最小权限管理，对关闭系统仅限管理员帐号。 
这最小权限管理不知道怎么衡量

#### A-2任务二 数据库加固（Data）
1.以普通帐户MySql安全运行MySql，禁止MySql以管理员帐号权限运行;
2.删除默认数据库(test);

```sql
drop database test;
```

2.	改变默认MySql管理员用户为:SuperRoot;

```sql
update user set User = "SuperRoot" where User = "root"; 
```
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093753792.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

3.	使用MySql内置MD5加密函数加密用户user1的密码为(P@ssw0rd1!);

```sql
select length(password('12345'));
Update user set authentication_string=md5('P@ssw0rd1!') where user = 'user1';
```
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020100609380118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)
后

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093807937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

4.	赋予user1用户对数据库所有表只有select,insert,delete,update权限；

```sql
grant select,insert,delete,update on *.* to 'user1'@'localhost';
```
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093832308.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

6. 对忘记mysql数据库SuperRoot管理员密码进行重置操作；
<font color='red'>操作：
 修改/etc/my.cof 添加skip-grant-tables


7. 禁用LOCAL INFILE命令防止非授权用户访问本地文件；
<font color='red'>操作：
修改/etc/my.cnf 添加local-infile=0

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006093942630.png#pic_center)

8. 为防止数据库操作信息泄露,请禁止使用MySql命令行历史记录;
<font color='red'> 操作：
rm ~/.mysql_history
ln -s /dev/null ~/.mysql_history

9. 为了分析数据库运行过程中的一些异常活动,请开启MySql二进制日志。 
<font color='red'> 操作：
添加 /etc/my.cnf
server-id=1
log-bin=binlog
log-bin-index=binlog.index

![在这里插入图片描述](https://img-blog.csdnimg.cn/2020100609402524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)



#### A-3任务三 Web安全加固(Web)
1.为了防止web中.mdb数据库文件非法下载，请对Web配置文件进行安全加固;
2.限制目录执行权限,对picture和upload目录设置执行权限为无；
3.开启IIS的日志审计记录(日志文件保存格式为W3C,只记录日期、时间、客户端IP地址、用户名、方法)；
4.为了减轻网站负载，设置网站最大并发连接数为1000；
5.防止文件枚举漏洞枚举网络服务器根目录文件，禁止IIS短文件名泄露；
6.关闭IIS的WebDAV功能增强网站的安全性。 


#### A-4任务四 流量完整性保护（Web,Data）
1.	对Web网站进行HTTP重定向HTTPS设置，仅使用HTTPS协议访问网站（Web）(注证书颁发给test.com 并通过https://www.test.com访问Web网站)；<font color='red'> 在web那台机器上做

<font color='red'> httpd.conf
去掉注释
LoadModule socache_shmcb_module modules/mod_socache_shmcb.so
Include conf/extra/httpd-ssl.conf
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094134681.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094139627.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'> 生成证书：
生成key文件
openssl genrsa -des3 -out httpd.key 1024
创建服务器证书申请文件
openssl req -new -key httpd.key -out httpd.csr
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094204279.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)
签发crt文件
openssl x509 -req -days 365 -in httpd.csr -signkey httpd.key -out httpd.crt

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094213309.png#pic_center)

<font color='red'> 返回httpd-ssl.conf文件注释源内容，填写证书地址
SSLCertificateKeyFile "/home/ssl/httpd.key"
SSLCertificateFile "/home/ssl/httpd.crt"


![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094221968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)


<font color='red'> 重启服务

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094225597.png#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094232337.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'> 重定向：httpd.conf

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094240877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

```bash
# 补充配置HTTPS重定向
IncludeOptional conf.d/*.conf
<VirtualHost *:80>
        RewriteEngine on
        RewriteCond %{HTTPS} !=on
        RewriteRule ^(.*) https://%{SERVER_NAME}$1 [L,R]
        ServerName https://www.test.com
</VirtualHost>	
重启服务生效
```

2.	为了防止密码在登录或者传输信息中被窃取，仅使用证书登录SSH（Data）。<font color='red'> 在data服务器上做，应该是在本机生成，传data服务器

客户端：
生成公钥与私钥

```bash
ssh-keygen -t rsa 
```
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094411309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'> 会生成一个私钥跟公钥，一个公钥交data服务器，私钥留本地
Scp上data服务器

```bash
scp ssh_root_ca.pub root@*.*.*.*: /
```
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020100609450315.png#pic_center)
<font color='red'> data服务器

```bash
cat ssh_root_ca.pub >> ~/.ssh/authorized_keys
```
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094625237.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094638858.png#pic_center)
<font color='red'> 关闭密码认证

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094656774.png#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094700338.png#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094704513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

#### A-5任务五 事件监控（Web）
1.将Web服务器开启审核策略
登录事件 成功/失败;
特权使用 成功;
策略更改 成功/失败;
进程跟踪 成功/失败;
3.	配置splunk接收Web服务器，安全日志，系统日志，CPU负载，内存，磁盘空间，网络状态。




#### A-6任务六 服务加固ssh\vsFTPd （Data）
1.	修改ssh服务端口为2222;


![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094744756.png#pic_center)


2.	ssh禁止ROOT用户远程登录;
	
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094803929.png#pic_center)

3.	vsFTPd禁止匿名用户上传;

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094853795.png#pic_center)

4.	激活vsFTPd上传下载日志;
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094903225.png#pic_center)

5.	vsFTPd同一个IP只能连接两个;

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094913430.png#pic_center)

6.	vsFTPd将使客户端连接时的端口范围在50000和60000之间；

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094928997.png#pic_center)

7.	vsFTPd使本地用户登录活动范围限制在home目录。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006094941737.png#pic_center)

#### A-7任务七 防火墙策略

所有服务器开启防火墙,为防止勒索病毒攻击对防火墙进行加固策略：				<font color='red'> iptables 重启后会重置，要重新配置（最好不重启）

Windows系统禁用445端口；
<font color='red'> Windows防火墙入站规则

1.	Linux系统禁用23端口；			

```bash
iptables -A INPUT -p TCP --dport 23 -j DROP
iptables -A OUTPUT -p tcp --sport 23 -j DROP
```

2.	Linux系统禁止别人ping通；

```bash
iptables -A INPUT -p icmp --icmp 8 -j DROP
iptables -A OUTPUT -p icmp --icmp 0 -j DROP
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095057213.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

3.	Linux系统为确保安全禁止所有人连接ssh除了192.168.1.1这个ip。 

```bash
iptables -A INPUT -s 192.168.1.1 -p tcp -m tcp --dport 22 -j ACCEPT
iptables -A INPUT -s 0.0.0.0/0 -p tcp -m tcp --dport 22 -j DROP
```

![在这里插入图片描述](https://img-blog.csdnimg.cn/2020100609511234.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)



#  模块B 网络安全事件响应、数字取证调查和应用安全

（本模块40分，每个子任务4分）

一、项目和任务描述：
假定你是某网络安全技术支持团队成员，某企业的服务器系统被黑客攻击，你的团队前来帮助企业进行调查并追踪本次网络攻击的源头，分析黑客的攻击方式，发现系统漏洞，提交网络安全事件响应报告，修复系统漏洞，删除黑客在系统中创建的后门，并帮助系统恢复正常运行。
二、服务器环境参考（以实际赛题为准）
操作系统：Windows/Linux
三、PC机环境参考（以实际赛题为准）
物理机：Windows7或Windows10；
虚拟机1：Ubuntu Linux（用户名：root；密码：123456）,安装工具集：Backtrack5,安装开发环境：Python3；
虚拟机2：Kali1.0（用户名：root；密码：123456）；
虚拟机3：Kali2.0（用户名：root；密码：123456）；
虚拟机4：WindowsXP（用户名：administrator；密码：123456）。
四、具体任务
任务说明：flag格式：flag｛Xxxx123｝，括号中的内容作为flag值，提交Xxxx123即可


#### B-1任务一：Web安全渗透测试

任务环境说明：
服务器场景：server1
服务器场景用户名、密码：未知（关闭链接）
1.通过URL访问http://靶机IP/1，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；
2.通过URL访问http://靶机IP/2，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；
3.通过URL访问http://靶机IP/3，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；
4.通过URL访问http://靶机IP/4，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交；
5.通过URL访问http://靶机IP/5，对该页面进行渗透测试,将完成后返回的结果内容作为flag值提交。


#### B-2任务二：数据分析

*任务说明：仅能获取Server2的IP地址
1.使用Wireshark查看并分析Server2桌面下的capture.pcapng数据包文件，找出telnet服务器的用户名和密码，并将密码作为flag值提交；

<font color='red'> 一般在tcp连接后，telnet欢迎信息完了以后的第一个第二个包

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008171130494.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'> 如果后面有登录失败字样说明账户密码不是上面的，继续往下找

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008171333324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)




<font color='red'> 注意分析密码错误以后的包大小，看到相同包大小的telnet包，直接跳过，注意包很大，包跟错误密码的包不一样大小的包

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008171713266.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'>  登录成功后有协商信息

![在这里插入图片描述](https://img-blog.csdnimg.cn/202010081723455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'>   多用追溯流

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008172643155.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)






2.使用Wireshark查看并分析Server2桌面下的capture.pcapng数据包文件，FTP服务器已经传输文件结束，将登陆服务器后的第一条指令作为flag值提交；

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008172643155.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

3.使用Wireshark查看并分析Server2桌面下的capture.pcapng数据包文件，web服务器地址是192.168.181.250， 其使用的脚本语言为php，将服务器使用php的版本号作为flag值提交；

![在这里插入图片描述](https://img-blog.csdnimg.cn/2020100817295521.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)


4.使用Wireshark查看并分析Server2桌面下的capture.pcapng数据包文件，这些数据中有非常多的ICMP报文，其中有一个设备是路由器，IP地址为192.168.181.25，将路由器上主动发出的ping请求的数量作为flag值提交；

<font color='red'> code 8 回显请求 ，code 0 回显应答 
```bash
icmp and ip.src == 192.168.181.25 and icmp.type == 8
```

<font color='red'> Echo Reply 为应答 0
Echp Request 为请求	8 

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008175122376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008175158512.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'>  这个筛选出来的数据包里剔除了无关数据包，Wireshark No
也没有重新排列，所有，这个题不知道怎么办，如果有想法，或者知道怎么解的朋友，滴滴我。


![在这里插入图片描述](https://img-blog.csdnimg.cn/20201008185809622.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)







5.使用Wireshark查看并分析Server2桌面下的capture.pcapng数据包文件，这些数据中有ssh报文，由于ssh有加密功能，现需要将这些加密报文的算法分析出来，将ssh客户端支持的第一个算法的名称作为flag值提交。

<font color='red'>
交互算法可能是：
diffie-hellman-group-exchangesha1、diffie-hellman-group1-sha1 和diffie-hellman-group14-sha1 算法等。

<font color='red'>
加密算法可能是：3des-cbc、aes128-cbc 和des-cbc 加密算法等

<font color='red'>
认证算法可能是：RSA 和DSA 
<font color='red'>
校验算法可能是：hmac-md5、hmac-md5-96、hmacsha1和hmac-sha1-96 算法等。

可能应该大概是这里面的一个吧（笑声bb）
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020100819171316.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)




#### B-3任务三：数字取证

*任务说明：仅能获取Server3的IP地址
1.黑客是通过上传页面进行上传木马，将上传页面找到，上传页面文件名作为flag值提交；

2.找到对应的木马后门，将木马文件名作为flag值提交；
3.查看木马文件，将木马文件的登录密码进行提交；
		<font color='red'> 小马在post里，大马可能会放在前面位置。
可能会编码

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095332544.png#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095337641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

4.在任务计划中找到黑客所创建的任务计划（具有危险操作的任务计划），任务计划名为flag值提交；

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095428539.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)


5.找到任务计划所对应执行程序将分析代码将密码处作为flag值提交。


#### B-4任务四：内存取证

*任务说明：仅能获取Server4的IP地址

[https://code.google.com/archive/p/volatility/wikis/LinuxCommandReference23.wiki#linux_pidhashtable](https://code.google.com/archive/p/volatility/wikis/LinuxCommandReference23.wiki#linux_pidhashtable%20https://github.com/volatilityfoundation/volatility/wiki/Command-Reference#consoles)

[https://github.com/volatilityfoundation/volatility/wiki/Command-Reference#consoles](https://code.google.com/archive/p/volatility/wikis/LinuxCommandReference23.wiki#linux_pidhashtable%20https://github.com/volatilityfoundation/volatility/wiki/Command-Reference#consoles)


1.从内存中获取到用户admin的密码并且破解密码，以flag{admin,password}形式提交(密码为6位)；

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095524158.png#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095528427.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

2.获取当前系统ip地址及主机名，以flag{ip:主机名}形式提交；
<font color='red'>  网络信息里面可能会有恶意服务，挖矿进程的网络信息


![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095546417.png#pic_center)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095549566.png#pic_center)

4.	获取当前系统浏览器搜索过的关键词，作为flag提交；

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095603451.png#pic_center)


5.	当前系统中存在挖矿进程，请获取指向的矿池地址，以flag{ip:端口}形式提交；
<font color='red'>  Cmdline没有在dlllist，hivelist里找找
hivelist会有system和sam的地址


![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095629918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)



![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095633665.png#pic_center)


6.	恶意进程在系统中注册了服务，请将服务名以flag{服务名}形式提交。
<font color='red'>  Svcscan或者servicediff


![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095652856.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

<font color='red'>  5，6题在注册表中可能也会出现flag
Getservicesids

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201006095711304.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NjI2MDQz,size_16,color_FFFFFF,t_70#pic_center)

#### B-5任务五：Python代码分析

*任务说明：仅能获取Server5的IP地址,在Server5服务器桌面找到flag.py文件并完成以下任务。
1.完善文件flag.py文件，填写该文件当中空缺的flag1字符串，并将改字符串作为flag提交；
2.完善文件flag.py文件，填写该文件当中空缺的flag2字符串，并将改字符串作为flag提交；
3.完善文件flag.py文件，填写该文件当中空缺的flag3字符串，并将改字符串作为flag提交；
4.完善文件flag.py文件，填写该文件当中空缺的flag4字符串，并将改字符串作为flag提交；
5.将完善好的文件执行，将执行成功后的回显内容作为flag值提交。

#### B-6任务六：应急响应

*任务说明：仅能获取Server6的IP地址
1.黑客通过网络攻入本地服务器，在Web服务器的主页上外挂了一个木马链接，请你找到此链接并删除链接，将删除链接后的主页第一排标题栏显示的第三个单词，作为flag提交；
2.黑客攻入本地服务器的数据库服务器，并添加了除admin以外的具有一个管理员权限的超级用户，请你找到此用户并删除用户，将此用户的密码作为flag提交；
3.黑客攻入本地服务器，在本地服务器建立了多个超级用户，请你删除除了Administrator用户以外的其他超级管理员用户，在命令行窗口输入net user，将Administrator右边第一个单词作为flag提交；
4.黑客修改了服务器的启动内容，请你删除不必要的启动内容，打开任务管理器的“启动”标签栏，将名称列中所有的名称作为flag提交；（提交形式:名称1，名称2，名称3）
5.黑客在服务器某处存放了一个木马程序，请你找到此木马程序并清除木马。打开任务管理器的“进程”标签栏，将应用名称中的第三个单词作为flag提交。

#### B-7任务七：Windows操作系统渗透测试

*任务说明：仅能获取Server7的IP地址
1.通过本地PC中渗透测试平台Kali对服务器场景Server7进行系统服务及版本扫描渗透测试，并将该操作显示结果中445端口对应的服务状态信息作为flag值提交； 
2.找到网络适配器信息，将首选DNS服务器地址作为flag值提交；
3.找到桌面上111文件夹中后缀为.docx的文件，将文档内容作为flag值提交；
4.找到回收站内的文档，将文档内容作为flag值提交；
5.获取系统最高账户管理员的密码，将密码作为flag值提交。

#### B-8任务八：Linux操作系统渗透测试


*任务说明：仅能获取Server8的IP地址
1.通过本地PC中渗透测试平台Kali对服务器场景Server8进行系统服务及版本扫描渗透测试，并将该操作显示结果中21端口对应的服务版本信息字符串作为flag值提交； 
2.找到/var/www目录中的图片文件，将文件名称作为flag值提交；
3.找到/var/www目录中的图片文件，将图中的英文单词作为flag值提交；
4.找到/home/guest目录中的txt文件，将文件内容作为flag值提交；
5.找到/root目录中的txt文件，将文件内容作为flag值提交。
#### B-9任务九：缓冲区溢出渗透测试
*任务说明：仅能获取Server9的IP地址，Server9 FTP服务器用户名：admin，密码：123456
1.从靶机服务器场景FTP服务器中下载文件BO.py，编辑该Python程序文件，使该程序实现对Server9进行缓冲区溢出渗透测试的功能，填写该文件当中空缺的F1字符串，将该字符串作为flag值提交；
2.继续编辑命名为BO.py的Python程序文件，使该程序实现对Server9进行缓冲区溢出渗透测试的功能，填写该文件当中空缺的F2字符串，将该字符串作为flag值提交；
3.继续编辑命名为BO.py的Python程序文件，使该程序实现对Server9进行缓冲区溢出渗透测试的功能，填写该文件当中空缺的F3字符串，将该字符串作为flag值提交；
4.继续编辑命名为BO.py的Python程序文件，使该程序实现对Server9进行缓冲区溢出渗透测试的功能，填写该文件当中空缺的F4字符串，将该字符串作为flag值提交；
5.继续编辑命名为BO.py的Python程序文件，使该程序实现对Server9进行缓冲区溢出渗透测试的功能，成功渗透后找到Server9回收站内的文档，将文档内容作为flag值提交。
#### B-10任务十：远程代码执行渗透测试
*任务说明：仅能获取Server10的IP地址，Server10 FTP服务器用户名：admin，密码：123456
1.从靶机服务器场景FTP服务器中下载文件RCE.py，编辑该Python程序文件，使该程序实现对Server10进行远程代码执行渗透测试的功能，填写该文件当中空缺的F1字符串，将该字符串作为flag值提交；
2.继续编辑命名为RCE.py的Python程序文件，使该程序实现对Server10进行远程代码执行渗透测试的功能，填写该文件当中空缺的F2字符串，将该字符串作为flag值提交；
3.继续编辑命名为RCE.py的Python程序文件，使该程序实现对Server10进行远程代码执行渗透测试的功能，填写该文件当中空缺的F3字符串，将该字符串作为flag值提交；
4.继续编辑命名为RCE.py的Python程序文件，使该程序实现对Server10进行远程代码执行渗透测试的功能，填写该文件当中空缺的F4字符串，将该字符串作为flag值提交；
5.继续编辑命名为RCE.py的Python程序文件，使该程序实现对Server10进行远程代码执行测试的功能，成功渗透后找到Server10桌面上的文档，将文档内容作为flag值提交。

### <font color='red'>  参考18年国赛

#   模块C  CTF夺旗-攻击

（本模块20分）

一、项目和任务描述：
假定你是某企业的网络安全渗透测试工程师，负责企业某些服务器的安全防护，为了更好的寻找企业网络中可能存在的各种问题和漏洞。你尝试利用各种攻击手段，攻击特定靶机，以便了解最新的攻击手段和技术，了解网络黑客的心态，从而改善您的防御策略。
请根据《赛场参数表》提供的信息，在客户端使用谷歌浏览器登录攻击机。
二、操作系统环境说明：
客户机操作系统：Windows 10
攻击机操作系统：Kali Linux 2019版
靶机服务器操作系统：Linux/Windows 
三、漏洞情况说明：
1.服务器中的漏洞可能是常规漏洞也可能是系统漏洞；
2.靶机服务器上的网站可能存在命令注入的漏洞，要求选手找到命令注入的相关漏洞，利用此漏洞获取一定权限;
3.靶机服务器上的网站可能存在文件上传漏洞，要求选手找到文件上传的相关漏洞，利用此漏洞获取一定权限;
4.靶机服务器上的网站可能存在文件包含漏洞，要求选手找到文件包含的相关漏洞，与别的漏洞相结合获取一定权限并进行提权;
5.操作系统提供的服务可能包含了远程代码执行的漏洞，要求用户找到远程代码执行的服务，并利用此漏洞获取系统权限;
6.操作系统提供的服务可能包含了缓冲区溢出漏洞，要求用户找到缓冲区溢出漏洞的服务，并利用此漏洞获取系统权限;
7.操作系统中可能存在一些系统后门，选手可以找到此后门，并利用预留的后门直接获取到系统权限。
四、注意事项：
1.不能对裁判服务器进行攻击，警告一次后若继续攻击将判令该参赛队离场；
2.flag值为每台靶机服务器的唯一性标识，每台靶机服务器仅有1个；
3.选手攻入靶机后不得对靶机进行关闭端口、修改密码、重启或者关闭靶机、删除或者修改flag、建立不必要的文件等操作；
4.在登录自动评分系统后，提交靶机服务器的flag值，同时需要指定靶机服务器的IP地址；
5.赛场根据难度不同设有不同基础分值的靶机，对于每个靶机服务器，前三个获得flag值的参赛队在基础分上进行加分，本阶段每个队伍的总分均计入阶段得分，具体加分规则参照赛场评分标准；
6.本环节不予补时。

#   模块D  CTF夺旗-防御

 （本模块20分）

一、项目和任务描述：
假定各位选手是某安全企业的网络安全工程师，负责若干服务器的渗透测试与安全防护，这些服务器可能存在着各种问题和漏洞。你需要尽快对这些服务器进行渗透测试与安全防护。每个参赛队拥有专属的堡垒机服务器，其他队不能访问。参赛选手通过扫描、渗透测试等手段检测自己堡垒服务器中存在的安全缺陷，进行针对性加固，从而提升系统的安全防御性能。
请根据《赛场参数表》提供的信息，在客户端使用谷歌浏览器登录需要加固的堡垒服务器。
二、操作系统环境说明：
客户机操作系统：Windows 10
攻击机操作系统：Kali Linux 2019版
堡垒服务器操作系统：Linux/Windows
三、漏洞情况说明：
1.堡垒服务器中的漏洞可能是常规漏洞也可能是系统漏洞；
2.堡垒服务器上的网站可能存在命令注入的漏洞，要求选手找到命令注入的相关漏洞，利用此漏洞获取一定权限;
3.堡垒服务器上的网站可能存在文件上传漏洞，要求选手找到文件上传的相关漏洞，利用此漏洞获取一定权限;
4.堡垒服务器上的网站可能存在文件包含漏洞，要求选手找到文件包含的相关漏洞，与别的漏洞相结合获取一定权限并进行提权;
5.操作系统提供的服务可能包含了远程代码执行的漏洞，要求用户找到远程代码执行的服务，并利用此漏洞获取系统权限;
6.操作系统提供的服务可能包含了缓冲区溢出漏洞，要求用户找到缓冲区溢出漏洞的服务，并利用此漏洞获取系统权限;
7.操作系统中可能存在一些系统后门，选手可以找到此后门，并利用预留的后门直接获取到系统权限。
四、注意事项：
1.每位选手需要对加固点和加固过程截图，并自行制作系统防御实施报告，最终评分以实施报告为准;
2.系统加固时需要保证堡垒服务器对外提供服务的可用性；
3.不能对裁判服务器进行攻击，警告一次后若继续攻击将判令该参赛队离场；
4.本环节不予补时。


2020/10/6